# OmniSwarm v0.2 First-1000 Master Plan

Status: Implemented in codebase (operational rollout pending)  
Date: 2026-02-19  
Scope: Turn v0.1 experimental core into a safe, verifiable, launch-ready "first 1000 nodes" system.

## Execution Status (2026-02-19)

- P6 implemented: sandbox + deny-by-default policy + kill switch + safety tests.
- P7 implemented: rendezvous + signed heartbeat + IPFS health/degrade path + tests.
- P8 implemented: verification-driven fitness + async consensus verifier + rollback/penalty path.
- P9 implemented: signed receipts + replay protection + deterministic settlement snapshots + anti-sybil guardrails.
- P10 implemented: health snapshot, telemetry hooks, observability docs, incident runbooks.
- P11 implemented: first-1000 launch program docs, support playbook, issue labels, canary scripts.
- P12 implemented: governance docs (node policy, override, dispute policy), diagnostics/attestation export.

Operational caveat:
- Live 100/300/1000 cohort gates require real runtime duration and cannot be "completed" purely by local code changes.

## 1) Reality Check

Current baseline (verified locally):
- 87/87 tests pass.
- P3-P5 delivered: distributed coordinator, release pipeline, token conservation guard, claim artifacts.
- Runtime remains experimental and simulation-heavy in critical paths.

Non-negotiable constraint:
- "Perfect" is not a deployable engineering target.
- Deployable target is: "bounded-risk v0.2 with explicit safeguards, measurable reliability, and rollback."

## 2) v0.2 North Star

Build a controlled decentralized research network where:
- Nodes can contribute safely without arbitrary host compromise.
- P2P discovery works under real-world network constraints.
- Evolution rewards verifiable value, not idle/no-op behavior.
- Royalty/accounting is auditable and conservation-safe.
- The first 1000-node cohort can run reproducibly with operational visibility.

## 3) Program Milestones (P6-P12)

## P6 - Safe Execution Kernel (Week 1)

Goal:
- Remove arbitrary code execution risk and introduce strict capability boundaries.

Deliverables:
- `core/sandbox.py` capability gate with deny-by-default policy.
- Skill allowlist for node actions: read-only compute/search/summarize primitives.
- Isolated workspace root (for example `.omni_sandbox/`) with path jail checks.
- Risk-tiered action policy:
  - Low risk: auto-allowed.
  - Medium risk: explicit local confirmation.
  - High risk: blocked in v0.2.
- Global kill switch and emergency halt mechanism.

Acceptance criteria:
- Host filesystem access outside sandbox path is blocked by tests.
- Network egress policy is enforced by tests for disallowed targets.
- Any non-allowlisted tool invocation fails closed.
- Security regression suite passes.

## P7 - Real Connectivity Layer (Week 2)

Goal:
- Move from local/simulated discovery fallback to real-world resilient connectivity.

Deliverables:
- Hybrid discovery architecture:
  - Node-to-node transport for reachable peers.
  - Regional rendezvous/supernode signaling for NAT-heavy clients.
- Signed heartbeat remains mandatory.
- Peer health scoring and stale peer eviction.
- Connectivity diagnostics CLI command.

Acceptance criteria:
- 3 independent nodes discover each other under NAT-like conditions within SLA (<= 10s target for healthy signaling path).
- Drop/reconnect scenarios recover automatically.
- Message authenticity failures are observable in metrics and logs.

## P8 - Verification-Driven Evolution (Week 3)

Goal:
- Make evolution depend on validated outcomes, not superficial completion.

Deliverables:
- `fitness.py` with weighted multi-factor scoring:
  - Task completion signal.
  - Reproducibility score.
  - Cross-swarm verification consensus.
  - Latency/resource efficiency.
- Proof-of-Verification flow:
  - Primary swarm output is re-checked by sampled verifier swarms.
  - Consensus threshold controls reward eligibility.
- Evolution lineage log with generation provenance and rollback pointer.

Acceptance criteria:
- No-op outputs receive near-zero fitness.
- Contradictory verifier outcomes reduce reward and block promotion.
- Generation rollback restores previous stable population deterministically.

## P9 - Economic Integrity and Anti-Sybil (Week 4)

Goal:
- Protect reward system from fake contribution and accounting abuse.

Deliverables:
- Signed contribution receipts per task segment.
- Anti-sybil guardrails for first cohort:
  - Device fingerprint policy (privacy-preserving hash approach).
  - Rate limits and stake-based participation gates.
- Deterministic royalty settlement snapshot generation.
- On-chain bridge prep interface (testnet-first), keeping local ledger as source-of-truth fallback.

Acceptance criteria:
- Conservation invariant remains true across all settlement paths.
- Duplicate/fake contribution attempts are rejected and audited.
- Replay of previous receipts does not produce double credit.

## P10 - Reliability, Observability, and SRE Readiness (Week 5)

Goal:
- Make failures diagnosable and operations sustainable for 1000-node pilot.

Deliverables:
- Structured logging schema and correlation IDs.
- Metrics set:
  - Discovery latency.
  - Verification pass rate.
  - Consensus failure rate.
  - Evolution promotion failure rate.
  - Signature failure rate.
- Health endpoints and node self-check.
- Incident runbook: bootstrap failure, partition, signature storm, reward mismatch.

Acceptance criteria:
- Critical incidents are detectable in under 5 minutes.
- Runbook drills executed and documented.
- Release rollback procedure validated end-to-end.

## P11 - First-1000 Launch Program (Week 6)

Goal:
- Controlled onboarding of first 1000 nodes with quality gates.

Deliverables:
- Cohort strategy:
  - 100 canary nodes.
  - 300 expanded beta.
  - 1000 capped public cohort.
- Installer + binary verification flow.
- Node attestation and diagnostics upload (opt-in).
- Support playbook and issue triage labels.

Acceptance criteria:
- Canary cohort runs 7 days with no Sev-1 incident.
- Expansion cohorts meet stability SLO before next gate.
- Onboarding success rate and activation metrics tracked.

## P12 - Governance, Legal, and Trust Layer (Parallel track, Week 1-6)

Goal:
- Avoid legal and trust collapse before scaling.

Deliverables:
- Clear policy docs:
  - What the node can and cannot do.
  - User consent boundaries.
  - Data retention policy.
  - Reward dispute policy.
- Human override governance for high-risk actions.
- Public transparency report template for pilot.

Acceptance criteria:
- All high-risk actions require explicit policy gate.
- Reward disputes can be reproduced from signed logs.
- Public docs match actual runtime behavior.

## 4) Required Code Tracks

Track A - Security Core:
- `core/sandbox.py`
- `core/policy_engine.py`
- `tests/test_sandbox.py`
- `tests/test_policy_engine.py`

Track B - Network Reliability:
- `core/p2p_discovery.py` hardening
- `core/rendezvous.py`
- `tests/test_p2p_rendezvous.py`

Track C - Evolution Validity:
- `core/fitness.py`
- `core/evolution.py` integration
- `tests/test_fitness.py`
- `tests/test_evolution_consensus.py`

Track D - Economy Integrity:
- `token/omni_token.py` receipt integration
- `token/settlement_snapshot.py`
- `tests/test_settlement_integrity.py`

Track E - Ops:
- `core/telemetry.py`
- `core/health.py`
- `docs/runbooks/*.md`

## 5) Definition of Done for v0.2

v0.2 is done only if all are true:
- Security: capability sandbox enforced and tested.
- Network: multi-node discovery reliable in real-world constrained topology.
- Evolution: verification-based fitness active in runtime path.
- Economy: anti-sybil and signed receipts integrated; conservation invariant green.
- Ops: observability + runbooks + rollback validated.
- Launch: canary and beta gates passed before opening first 1000.

## 6) Git Execution Model

Branch strategy:
- `main` protected.
- Feature branches by milestone: `feat/p6-sandbox`, `feat/p7-connectivity`, etc.

Commit policy:
- Small vertical commits with tests in same change.
- No merge without passing full test matrix.

Release policy:
- `v0.2.0-rc1` after P6-P10 completion.
- `v0.2.0` only after canary and beta gate metrics pass.

## 7) Immediate Next 72 Hours

1. Ship P6 minimal sandbox skeleton with deny-by-default + tests.
2. Integrate sandbox check into `core/node.py` action path.
3. Add telemetry skeleton for policy violations and signature failures.
4. Produce `v0.2.0-alpha1` internal tag and run 10-node stress test.
